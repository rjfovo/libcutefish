#!/usr/bin/make -f

%:
	dh $@ --noparallel

override_dh_auto_configure:
	dh_auto_configure -- -DEMBED_TRANSLATIONS=ON -DBUILD_TESTING=ON

override_dh_auto_install:
	dh_auto_install --destdir=debian/libcutefish/
	# 手动安装QML模块文件
	install -d debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/
	cp -r obj-x86_64-linux-gnu/accounts/Cutefish debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/ 2>/dev/null || true
	cp -r obj-x86_64-linux-gnu/audio/Cutefish debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/ 2>/dev/null || true
	cp -r obj-x86_64-linux-gnu/bluez/Cutefish debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/ 2>/dev/null || true
	cp -r obj-x86_64-linux-gnu/mpris/Cutefish debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/ 2>/dev/null || true
	cp -r obj-x86_64-linux-gnu/networkmanagement/Cutefish debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/ 2>/dev/null || true
	cp -r obj-x86_64-linux-gnu/screen/Cutefish debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/ 2>/dev/null || true
	cp -r obj-x86_64-linux-gnu/system/Cutefish debian/libcutefish/usr/lib/x86_64-linux-gnu/qt6/qml/ 2>/dev/null || true
	# 安装共享库
	install -d debian/libcutefish/usr/lib/x86_64-linux-gnu/
	install -m 644 obj-x86_64-linux-gnu/accounts/libcutefishaccounts_qmlplugins.so debian/libcutefish/usr/lib/x86_64-linux-gnu/
	install -m 644 obj-x86_64-linux-gnu/audio/libcutefishaudio_qmlplugins.so debian/libcutefish/usr/lib/x86_64-linux-gnu/
	install -m 644 obj-x86_64-linux-gnu/bluez/libcutefishbluez_qmlplugins.so debian/libcutefish/usr/lib/x86_64-linux-gnu/
	install -m 644 obj-x86_64-linux-gnu/mpris/libcutefishmpris_qmlplugins.so debian/libcutefish/usr/lib/x86_64-linux-gnu/
	install -m 644 obj-x86_64-linux-gnu/networkmanagement/libcutefishnm_qmlplugins.so debian/libcutefish/usr/lib/x86_64-linux-gnu/
	install -m 644 obj-x86_64-linux-gnu/screen/libcutefishscreen_qmlplugins.so debian/libcutefish/usr/lib/x86_64-linux-gnu/
	install -m 644 obj-x86_64-linux-gnu/system/libcutefishsystem_qmlplugins.so debian/libcutefish/usr/lib/x86_64-linux-gnu/ 2>/dev/null || true
